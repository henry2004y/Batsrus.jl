<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manual · Batsrus.jl</title><meta name="title" content="Manual · Batsrus.jl"/><meta property="og:title" content="Manual · Batsrus.jl"/><meta property="twitter:title" content="Manual · Batsrus.jl"/><meta name="description" content="Documentation for Batsrus.jl."/><meta property="og:description" content="Documentation for Batsrus.jl."/><meta property="twitter:description" content="Documentation for Batsrus.jl."/><meta property="og:url" content="https://henry2004y.github.io/Batsrus.jl/man/manual/"/><meta property="twitter:url" content="https://henry2004y.github.io/Batsrus.jl/man/manual/"/><link rel="canonical" href="https://henry2004y.github.io/Batsrus.jl/man/manual/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../democards/nocoverlisttheme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li class="is-active"><a class="tocitem" href>Manual</a><ul class="internal"><li><a class="tocitem" href="#IDL-format-output-loader"><span>IDL format output loader</span></a></li><li><a class="tocitem" href="#Output-format-conversion"><span>Output format conversion</span></a></li><li><a class="tocitem" href="#HDF-format-output-loader"><span>HDF format output loader</span></a></li><li><a class="tocitem" href="#Data-visualization"><span>Data visualization</span></a></li><li><a class="tocitem" href="#AMReX-Particle-Data"><span>AMReX Particle Data</span></a></li></ul></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../internal/">Internal</a></li><li><a class="tocitem" href="../log/">Log</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Manual</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Manual</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/henry2004y/Batsrus.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/henry2004y/Batsrus.jl/blob/master/docs/src/man/manual.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="IDL-format-output-loader"><a class="docs-heading-anchor" href="#IDL-format-output-loader">IDL format output loader</a><a id="IDL-format-output-loader-1"></a><a class="docs-heading-anchor-permalink" href="#IDL-format-output-loader" title="Permalink"></a></h2><ul><li>Read data</li></ul><pre><code class="language-julia hljs">file = &quot;1d_bin.out&quot;;
bd = load(file);
bd = load(file, verbose=true);
bd = load(file, npict=1);</code></pre><ul><li>3D structured spherical coordinates</li></ul><pre><code class="language-julia hljs">file = &quot;3d_structured.out&quot;;
bd = load(file, verbose=false);</code></pre><ul><li>log file</li></ul><pre><code class="language-julia hljs">logfilename = &quot;shocktube.log&quot;;
head, data = readlogdata(logfilename)</code></pre><h3 id="Data-Extraction"><a class="docs-heading-anchor" href="#Data-Extraction">Data Extraction</a><a id="Data-Extraction-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Extraction" title="Permalink"></a></h3><ul><li>Checking variable range</li></ul><pre><code class="language-julia hljs">get_var_range(bd, &quot;rho&quot;)</code></pre><ul><li>Raw variables</li></ul><p>Note that the variable names for queries must be in lowercase!</p><pre><code class="language-julia hljs">ρ = getvar(bd, &quot;rho&quot;)
bd[&quot;rho&quot;]</code></pre><ul><li>Extracting data at a given location</li></ul><pre><code class="language-julia hljs">loc = Float32[0.0, 0.0] # The type determines the output type
d = interp1d(bd, &quot;rho&quot;, loc)</code></pre><ul><li>Extracting data along a given line</li></ul><pre><code class="language-julia hljs">point1 = Float32[-10.0, -1.0]
point2 = Float32[10.0, 1.0]
w = interp1d(bd, &quot;rho&quot;, point1, point2)</code></pre><pre><code class="language-julia hljs">bd[&quot;rho&quot;][X=-10 .. 10, Y=Near(0.0)]</code></pre><ul><li>Extracting data using DimensionalData</li></ul><p>We can also use <a href="https://rafaqz.github.io/DimensionalData.jl/stable/selectors">Selectors</a> from DimensionalData for extracting data. Note that the Selectors need to be imported from Batsrus.jl; alternatively you can simply <code>using DimensionalData</code>.</p><pre><code class="language-julia hljs">bd[&quot;rho&quot;][X=At(0.0), Y=At(0.0)]
bd[&quot;rho&quot;][X=-10 .. 10, Y=Near(0.5)]
bd[&quot;rho&quot;][X=-10 .. 10, Y=-0.5 .. 0.5]</code></pre><ul><li>Derived variables</li></ul><p>We provide utility methods <code>get_magnitude</code>, <code>get_magnitude2</code>, and <code>fill_vector_from_scalars</code> for vector processing:</p><pre><code class="language-julia hljs">Bmag = get_magnitude(bd, :B)
B2 = get_magnitude2(bd, :B)
Bvec = Batsrus.fill_vector_from_scalars(bd, :B)
paniso0 = get_anisotropy(bd, 0)</code></pre><p>These are built upon <code>get_vectors</code>. <code>fill_vector_from_scalars</code> is slower than <code>get_vectors</code> since it involves additional array allocations. Here is a full list of predefined derived quantities in <code>get_vectors</code>:</p><table><tr><th style="text-align: right">Derived variable name</th><th style="text-align: right">Meaning</th><th style="text-align: right">Required variable</th></tr><tr><td style="text-align: right">:B</td><td style="text-align: right">Magnetic field vector</td><td style="text-align: right">Bx, By, Bz</td></tr><tr><td style="text-align: right">:E</td><td style="text-align: right">Electric field vector</td><td style="text-align: right">Ex, Ey, Ez</td></tr><tr><td style="text-align: right">:U</td><td style="text-align: right">Velocity vector</td><td style="text-align: right">Ux, Uy, Uz</td></tr><tr><td style="text-align: right">:U0</td><td style="text-align: right">Electron velocity vector</td><td style="text-align: right">UxS0, UyS0, UzS0</td></tr><tr><td style="text-align: right">:U1</td><td style="text-align: right">Proton velocity vector</td><td style="text-align: right">UxS1, UyS1, UzS1</td></tr></table><h2 id="Output-format-conversion"><a class="docs-heading-anchor" href="#Output-format-conversion">Output format conversion</a><a id="Output-format-conversion-1"></a><a class="docs-heading-anchor-permalink" href="#Output-format-conversion" title="Permalink"></a></h2><p>We can convert 2D/3D BATSRUS outputs <code>*.dat</code> to VTK formats. It uses the VTK XML format writer <a href="https://github.com/jipolanco/WriteVTK.jl">writeVTK</a> to generate files for Paraview and Tecplot. The default converted filename is <code>out.vtu</code>.</p><ul><li>ASCII Tecplot file (supports both <code>tec</code> and <code>tcp</code>) and binary Tecplot file (set <code>DOSAVETECBINARY=TRUE</code> in BATSRUS <code>PARAM.in</code>):</li></ul><pre><code class="language-julia hljs">file = &quot;x=0_mhd_1_n00000050.dat&quot;
convertTECtoVTU(file)</code></pre><ul><li>3D structured IDL file (<code>gridType=:vti</code> returns image <code>vti</code> file, <code>gridType=:vtr</code> returns rectilinear <code>vtr</code> file, <code>gridType=:vts</code> returns structured <code>vts</code> file):</li></ul><pre><code class="language-julia hljs">file = &quot;3d_structured.out&quot;
convertIDLtoVTK(file, gridType=:vti)</code></pre><ul><li>3D unstructured IDL file together with header and tree file:</li></ul><pre><code class="language-julia hljs">filetag = &quot;3d_var_1_n00002500&quot;
convertIDLtoVTK(filetag)</code></pre><div class="admonition is-info" id="Note-78cc4f98d43fe041"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-78cc4f98d43fe041" title="Permalink"></a></header><div class="admonition-body"><p>The file suffix should not be provided for this to work correctly!</p></div></div><ul><li>Multiple files:</li></ul><pre><code class="language-julia hljs">dir = &quot;./&quot;
filenames = filter(file -&gt; startswith(file, &quot;3d&quot;) &amp;&amp; endswith(file, &quot;.dat&quot;), readdir(dir))
filenames = dir .* filenames

for filename in filenames
   convertTECtoVTU(filename, filename[1:end-4])
end</code></pre><ul><li>Processing multiple files with threads in parallel:</li></ul><pre><code class="language-julia hljs">dir = &quot;./&quot;
filenames = filter(file -&gt; startswith(file, &quot;3d&quot;) &amp;&amp; endswith(file, &quot;.dat&quot;), readdir(dir))
filenames = dir .* filenames

Threads.@threads for filename in filenames
   println(&quot;filename=$filename&quot;)
   convertTECtoVTU(filename, filename[1:end-4])
end</code></pre><p>More examples can be found in <a href="https://github.com/henry2004y/Batsrus.jl/tree/master/examples">examples</a>.</p><h2 id="HDF-format-output-loader"><a class="docs-heading-anchor" href="#HDF-format-output-loader">HDF format output loader</a><a id="HDF-format-output-loader-1"></a><a class="docs-heading-anchor-permalink" href="#HDF-format-output-loader" title="Permalink"></a></h2><pre><code class="language-julia hljs">filename = &quot;3d__var_1_n00006288.h5&quot;
file = BatsrusHDF5Uniform(filename)</code></pre><h3 id="Field-extraction"><a class="docs-heading-anchor" href="#Field-extraction">Field extraction</a><a id="Field-extraction-1"></a><a class="docs-heading-anchor-permalink" href="#Field-extraction" title="Permalink"></a></h3><p>Variable <code>var</code> can be extracted in the whole domain:</p><pre><code class="language-julia hljs">var, (xl_new, yl_new, zl_new), (xu_new, yu_new, zu_new) = extract_var(file, &quot;bx&quot;)</code></pre><p>where <code>(xl_new, yl_new, zl_new)</code> and <code>(xu_new, yu_new, zu_new)</code> return the lower and upper bound, respectively.</p><p>Variables within a box region can be extracted as following:</p><pre><code class="language-julia hljs">var, (xl_new, yl_new, zl_new), (xu_new, yu_new, zu_new) =
   extract_var(file, &quot;bx&quot;; xmin, xmax, ymin, ymax, zmin, zmax)</code></pre><h2 id="Data-visualization"><a class="docs-heading-anchor" href="#Data-visualization">Data visualization</a><a id="Data-visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Data-visualization" title="Permalink"></a></h2><p>We provide plot recipes for Plots.jl, Makie.jl, and wrappers for PyPlot.jl.</p><p>The recipes for Plots.jl and Makie.jl will work on all kinds of plots given the correct dimensions, e.g.</p><pre><code class="language-julia hljs">using Plots

plot(bd, &quot;p&quot;)
contourf(bd, &quot;Mx&quot;, xlabel=&quot;x&quot;)</code></pre><p>See the official documentation for Plots.jl for more information.</p><p>On the other hand, most common 1D and 2D plotting functions are wrapped over their Matplotlib equivalences through PyPlot.jl. To trigger the wrapper, <code>using PyPlot</code>. Check out the documentation for more details.</p><h3 id="Quick-exploration-of-data"><a class="docs-heading-anchor" href="#Quick-exploration-of-data">Quick exploration of data</a><a id="Quick-exploration-of-data-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-exploration-of-data" title="Permalink"></a></h3><p>Using the same plotting functions as in Matplotlib is allowed, and actually recommended. This takes advantage of multiple dispatch mechanism in Julia. Some plotting functions can be directly called as shown below, which allows for more control from the user. <code>using PyPlot</code> to import the full capability of the package, etc. adding colorbar, changing line colors, setting colorbar range with <code>clim</code>.</p><p>For 1D outputs, we can use <code>plot</code> or <code>scatter</code>.</p><ul><li>line plot</li></ul><pre><code class="language-julia hljs">plot(bd, &quot;p&quot;, linewidth=2, color=&quot;tab:red&quot;, linestyle=&quot;--&quot;, linewidth=2)</code></pre><ul><li>scatter plot</li></ul><pre><code class="language-julia hljs">scatter(bd, &quot;p&quot;)</code></pre><p>For 2D outputs, we can select the following functions:</p><ul><li><code>contour</code></li><li><code>contourf</code></li><li><code>imshow</code></li><li><code>pcolormesh</code></li><li><code>plot_surface</code></li><li><code>plot_tricontour</code></li><li><code>plot_tricontourf</code></li><li><code>plot_trisurf</code></li><li><code>tripcolor</code></li></ul><p>with either <code>quiver</code> or <code>streamplot</code>. By default the linear colorscale is applied. If you want to switch to logarithmic, set argument <code>colorscale=:log</code>.</p><ul><li>contour</li></ul><pre><code class="language-julia hljs">contour(bd, &quot;p&quot;)</code></pre><ul><li>filled contour</li></ul><pre><code class="language-julia hljs">contourf(bd, &quot;p&quot;)
contourf(bd, &quot;p&quot;; levels, plotrange=[-10,10,-Inf,Inf], plotinterval=0.1)</code></pre><ul><li>surface plot</li></ul><pre><code class="language-julia hljs">plot_surface(bd, &quot;p&quot;)</code></pre><ul><li>triangle surface plot</li></ul><pre><code class="language-julia hljs">plot_trisurf(bd, &quot;p&quot;)</code></pre><ul><li>triangle filled contour plot</li></ul><pre><code class="language-julia hljs">tricontourf(bd, &quot;p&quot;)</code></pre><ul><li>streamline</li></ul><pre><code class="language-julia hljs">streamplot(bd, &quot;bx;bz&quot;)
streamplot(bd, &quot;bx;bz&quot;; density=2.0, color=&quot;k&quot;, plotinterval=1.0, plotrange=[-10,10,-Inf,Inf])</code></pre><ul><li>quiver (currently only for Cartesian grid)</li></ul><pre><code class="language-julia hljs">quiver(bd, &quot;ux;uy&quot;; stride=50)</code></pre><ul><li>streamline + contourf</li></ul><pre><code class="language-julia hljs">file = &quot;y.out&quot;
bd = load(file)

DN = matplotlib.colors.DivergingNorm
cmap = matplotlib.cm.RdBu_r

contourf(bd, &quot;uxS0&quot;, 50; plotrange=[-3,3,-3,3], plotinterval=0.05, norm=DN(0), cmap)
colorbar()
streamplot(bd, &quot;uxS0;uzS0&quot;; density=2.0, color=&quot;g&quot;, plotrange=[-3,3,-3,3])
xlabel(&quot;x&quot;); ylabel(&quot;y&quot;); title(&quot;Ux [km/s]&quot;)

contourf(bd, &quot;uxS0&quot;, 50; plotinterval=0.05, norm=DN(0), cmap)
colorbar()
axis(&quot;scaled&quot;)
xlabel(&quot;x&quot;); ylabel(&quot;y&quot;); title(&quot;uxS0&quot;)</code></pre><p>For 3D outputs, we may use <code>cutplot</code> for visualizing on a sliced plane, or <code>streamslice</code> to plot streamlines on a given slice.</p><h4 id="Finding-indexes"><a class="docs-heading-anchor" href="#Finding-indexes">Finding indexes</a><a id="Finding-indexes-1"></a><a class="docs-heading-anchor-permalink" href="#Finding-indexes" title="Permalink"></a></h4><p>To get the index of a certain quantity, e.g. electron number density</p><pre><code class="language-julia hljs">ρe_= findfirst(x-&gt;x==&quot;rhos0&quot;, bd.head.wname)</code></pre><h4 id="Get-variable-range"><a class="docs-heading-anchor" href="#Get-variable-range">Get variable range</a><a id="Get-variable-range-1"></a><a class="docs-heading-anchor-permalink" href="#Get-variable-range" title="Permalink"></a></h4><pre><code class="language-julia hljs">wmin, wmax = get_var_range(bd, var)</code></pre><h3 id="Tracing"><a class="docs-heading-anchor" href="#Tracing">Tracing</a><a id="Tracing-1"></a><a class="docs-heading-anchor-permalink" href="#Tracing" title="Permalink"></a></h3><p>The built-in <code>streamplot</code> function in Matplotlib is not satisfactory for accurately tracing. Instead we recommend <a href="https://github.com/henry2004y/FieldTracer.jl">FieldTracer.jl</a> for tracing fieldlines and streamlines.</p><p>An example of tracing in a 2D cut and plot the field lines over contour:</p><pre><code class="language-julia hljs">file = &quot;test/y=0_var_1_t00000000_n00000000.out&quot;
bd = load(file)

bx = bd.w[:,:,5]
bz = bd.w[:,:,7]
x  = bd.x[:,1,1]
z  = bd.x[1,:,2]

seeds = select_seeds(x, z; nSeed=100) # randomly select the seeding points

for i in 1:size(seeds)[2]
   xs = seeds[1,i]
   zs = seeds[2,i]
   # Tracing in both direction. Check the document for more options.
   x1, z1 = trace2d_eul(bx, bz, xs, zs, x, z, ds=0.1, maxstep=1000, gridType=&quot;ndgrid&quot;)
   plot(x1, z1, &quot;--&quot;)
end
axis(&quot;equal&quot;)</code></pre><p>Currently the <code>select_seeds</code> function uses pseudo random number generator that produces the same seeds every time.</p><h2 id="AMReX-Particle-Data"><a class="docs-heading-anchor" href="#AMReX-Particle-Data">AMReX Particle Data</a><a id="AMReX-Particle-Data-1"></a><a class="docs-heading-anchor-permalink" href="#AMReX-Particle-Data" title="Permalink"></a></h2><p>We provide support for reading and analyzing AMReX particle data.</p><h3 id="Loading-Data"><a class="docs-heading-anchor" href="#Loading-Data">Loading Data</a><a id="Loading-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-Data" title="Permalink"></a></h3><p>To load AMReX particle data:</p><pre><code class="language-julia hljs">data = AMReXParticle(&quot;path/to/data_directory&quot;)</code></pre><p>This will parse the header and prepare for lazy loading of particle data.</p><h3 id="Phase-Space-Plotting"><a class="docs-heading-anchor" href="#Phase-Space-Plotting">Phase Space Plotting</a><a id="Phase-Space-Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Space-Plotting" title="Permalink"></a></h3><p>We can calculate and plot the phase space density distribution of particles.</p><p>First, load the PyPlot extension. The <code>plot_phase</code> function automatically calculates the density and plots it.</p><pre><code class="language-julia hljs">using PyPlot

plot_phase(data, &quot;x&quot;, &quot;vx&quot;; 
   bins=100, 
   x_range=(-10, 10), 
   y_range=(-5, 5),
   log_scale=true,
   plot_zero_lines=true,
   normalize=true
)</code></pre><p>We can also calculate the phase space density histogram directly without plotting:</p><pre><code class="language-julia hljs"># 1D density
hist1d = get_phase_space_density(data, &quot;vx&quot;)

# 2D density
hist2d = get_phase_space_density(data, &quot;x&quot;, &quot;vx&quot;; bins=(100, 50))

# 3D density
hist3d = get_phase_space_density(data, &quot;vx&quot;, &quot;vy&quot;, &quot;vz&quot;; bins=50)

# Weighted 2D density (automatically detects &quot;weight&quot; component if present)
# or passes weights explicitly if not in data
hist2d_w = get_phase_space_density(data, &quot;v_parallel&quot;, &quot;v_perp&quot;)</code></pre><p>We can also apply coordinate transformations to the particle data.</p><ol><li>Transformation with only B field. This decomposes velocity into parallel and perpendicular components relative to B.</li></ol><pre><code class="language-julia hljs">transform_b = get_particle_field_aligned_transform([1.0, 0.0, 0.0])

plot_phase(data, &quot;v_parallel&quot;, &quot;v_perp&quot;; 
   transform=transform_b,
   bins=50,
   log_scale=true
)</code></pre><ol><li>Transformation with both B and E fields. This creates an orthonormal basis (<span>$v_B$</span>, <span>$v_E$</span>, <span>$v_{B \times E}$</span>), where <span>$v_B$</span> is along B, <span>$v_E$</span> is along the perpendicular component of E, and <span>$v_{B \times E}$</span> is along the ExB drift direction.</li></ol><pre><code class="language-julia hljs">transform_eb = get_particle_field_aligned_transform([1.0, 0.0, 0.0], [0.0, 1.0, 0.0])

plot_phase(data, &quot;v_B&quot;, &quot;v_BxE&quot;; 
   transform=transform_eb,
   bins=50,
   log_scale=true
)</code></pre><h3 id="Particle-Classification"><a class="docs-heading-anchor" href="#Particle-Classification">Particle Classification</a><a id="Particle-Classification-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Classification" title="Permalink"></a></h3><p>You can classify particles into Core Maxwellian and Suprathermal populations using <code>classify_particles</code>. This function allows for specifying a spatial region and handling velocity distributions in 1D, 2D, or 3D.</p><pre><code class="language-julia hljs"># range can be specified by keywords x_range, y_range, z_range locally
core, halo = classify_particles(data; 
    x_range=(-1.0, 1.0), 
    y_range=(-1.0, 1.0), 
    z_range=(-1.0, 1.0),
    vdim=3,          # Velocity dimension (1, 2, or 3)
    vth=1.0,         # Core thermal velocity (required)
    nsigma=3.0,      # Separation threshold
    bulk_vel=nothing # Auto-detect if nothing
)</code></pre><p>The function returns two matrices containing the classified particles. If <code>bulk_vel</code> is not provided, it is automatically estimated from the peak of the velocity distribution.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 16 January 2026 22:42">Friday 16 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
