<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internal · Batsrus.jl</title><meta name="title" content="Internal · Batsrus.jl"/><meta property="og:title" content="Internal · Batsrus.jl"/><meta property="twitter:title" content="Internal · Batsrus.jl"/><meta name="description" content="Documentation for Batsrus.jl."/><meta property="og:description" content="Documentation for Batsrus.jl."/><meta property="twitter:description" content="Documentation for Batsrus.jl."/><meta property="og:url" content="https://henry2004y.github.io/Batsrus.jl/man/internal/"/><meta property="twitter:url" content="https://henry2004y.github.io/Batsrus.jl/man/internal/"/><link rel="canonical" href="https://henry2004y.github.io/Batsrus.jl/man/internal/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../democards/nocoverlisttheme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../manual/">Manual</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Internal</a><ul class="internal"><li><a class="tocitem" href="#Batsrus"><span>Batsrus</span></a></li><li><a class="tocitem" href="#UnitfulBatsrus"><span>UnitfulBatsrus</span></a></li><li><a class="tocitem" href="#HDF"><span>HDF</span></a></li></ul></li><li><a class="tocitem" href="../log/">Log</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Internal</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internal</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/henry2004y/Batsrus.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/henry2004y/Batsrus.jl/blob/master/docs/src/man/internal.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="APIs"><a class="docs-heading-anchor" href="#APIs">APIs</a><a id="APIs-1"></a><a class="docs-heading-anchor-permalink" href="#APIs" title="Permalink"></a></h1><h2 id="Batsrus"><a class="docs-heading-anchor" href="#Batsrus">Batsrus</a><a id="Batsrus-1"></a><a class="docs-heading-anchor-permalink" href="#Batsrus" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Batsrus.BATS"><a class="docstring-binding" href="#Batsrus.BATS"><code>Batsrus.BATS</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Alias for backward compatibility and convenience.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/type.jl#L67-L69">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.Batl"><a class="docstring-binding" href="#Batsrus.Batl"><code>Batsrus.Batl</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>BATSRUS output high-level struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L74-L76">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.BatsHead"><a class="docstring-binding" href="#Batsrus.BatsHead"><code>Batsrus.BatsHead</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Batsrus file head information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/type.jl#L23-L25">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.BatsrusIDLStructured"><a class="docstring-binding" href="#Batsrus.BatsrusIDLStructured"><code>Batsrus.BatsrusIDLStructured</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Batsrus structured data container, with <code>Dim</code> being the dimension of output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/type.jl#L43-L45">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.BatsrusIDLUnstructured"><a class="docstring-binding" href="#Batsrus.BatsrusIDLUnstructured"><code>Batsrus.BatsrusIDLUnstructured</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Batsrus unstructured data container, with <code>Dim</code> being the dimension of output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/type.jl#L55-L57">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.FileList"><a class="docstring-binding" href="#Batsrus.FileList"><code>Batsrus.FileList</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Type for Batsrus file information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/type.jl#L5-L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.Head"><a class="docstring-binding" href="#Batsrus.Head"><code>Batsrus.Head</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>BATSRUS output standalone header information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L40-L42">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus._getfilesize_binary-Union{Tuple{T}, Tuple{IOStream, Integer, Val{T}}} where T"><a class="docstring-binding" href="#Batsrus._getfilesize_binary-Union{Tuple{T}, Tuple{IOStream, Integer, Val{T}}} where T"><code>Batsrus._getfilesize_binary</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getfilesize(fileID::IOStream, lenstr::Int32, ::Val{FileType})</code></pre><p>Return the size in bytes for one snapshot.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L382-L386">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.adjust_plotrange!-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#Batsrus.adjust_plotrange!-Tuple{Any, Any, Any}"><code>Batsrus.adjust_plotrange!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Adjust 2D plot ranges.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L184-L186">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.allocateBuffer-Union{Tuple{T}, Tuple{Batsrus.BatsHead, Type{T}}} where T"><a class="docstring-binding" href="#Batsrus.allocateBuffer-Union{Tuple{T}, Tuple{Batsrus.BatsHead, Type{T}}} where T"><code>Batsrus.allocateBuffer</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Create buffer for x and w.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L448-L450">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.classify_particles-Union{Tuple{AMReXParticle{T}}, Tuple{T}} where T"><a class="docstring-binding" href="#Batsrus.classify_particles-Union{Tuple{AMReXParticle{T}}, Tuple{T}} where T"><code>Batsrus.classify_particles</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">classify_particles(data, region; vdim=3, bulk_vel=nothing, vth=nothing, nsigma=3.0)</code></pre><p>Classify particles in a spatial region into core Maxwellian and suprathermal populations.</p><p><strong>Arguments</strong></p><ul><li><code>data::AMReXParticle</code>: Particle data.</li><li><code>region</code>: Passed as kwargs <code>x_range</code>, <code>y_range</code>, <code>z_range</code>.</li><li><code>vdim</code>: Velocity dimension (1, 2, or 3).</li><li><code>bulk_vel</code>: Core bulk velocity. If <code>nothing</code>, estimated from peak density.</li><li><code>vth</code>: Core thermal velocity. Must be provided.</li><li><code>nsigma</code>: Threshold for classification in units of thermal velocity.</li></ul><p><strong>Returns</strong></p><ul><li><code>(core, suprathermal)</code>: Two matrices containing the classified particles.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/amrex.jl#L812-L829">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.cutdata-Tuple{BatsrusIDL, AbstractString}"><a class="docstring-binding" href="#Batsrus.cutdata-Tuple{BatsrusIDL, AbstractString}"><code>Batsrus.cutdata</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">cutdata(data, var; plotrange=[-Inf,Inf,-Inf,Inf], dir=&quot;x&quot;, sequence=1)</code></pre><p>Get 2D plane cut in orientation <code>dir</code> for <code>var</code> out of 3D box <code>data</code> within <code>plotrange</code>. The returned 2D data lies in the <code>sequence</code> plane from - to + in <code>dir</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L5-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.fillCellNeighbors!-Tuple{Batl, Vararg{Any, 4}}"><a class="docstring-binding" href="#Batsrus.fillCellNeighbors!-Tuple{Batl, Vararg{Any, 4}}"><code>Batsrus.fillCellNeighbors!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> fillCellNeighbors!(batl, iCell_G, DiLevelNei_III, iNodeNei_III, nBlock_P)</code></pre><p>Fill neighbor cell indexes for the given block. The faces, edges, and vertices are ordered from left (-) to right (+) in x-y-z sequentially.</p><p>Vertices:        Edges: (10,11 ignored)</p><pre><code class="language-julia hljs">7 ----- 8        . --4-- .</code></pre><ul><li>.     - .      7 .     8 . 5 ––- 6  .     . –3– .  12 .  .    .  .     .  .    .  . .  3 ––- 4     9  . –2– . . -     . -      . 5     . 6 1 ––- 2        . –1– .</li></ul><p>Only tested for 3D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L669-L687">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.fill_vector_from_scalars-Tuple{BatsrusIDL, Any}"><a class="docstring-binding" href="#Batsrus.fill_vector_from_scalars-Tuple{BatsrusIDL, Any}"><code>Batsrus.fill_vector_from_scalars</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> fill_vector_from_scalars(bd::BatsrusIDL, var)</code></pre><p>Construct vector of <code>var</code> from its scalar components. Alternatively, check <a href="#Batsrus.get_vectors-Tuple{BatsrusIDL, Any}"><code>get_vectors</code></a> for returning vector components as separate arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L199-L204">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.find_grid_block-Tuple{Batl, Any}"><a class="docstring-binding" href="#Batsrus.find_grid_block-Tuple{Batl, Any}"><code>Batsrus.find_grid_block</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> find_grid_block(batl, xyz_D)</code></pre><p>Return processor local block index that contains a point. Input location should be given in Cartesian coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L192-L197">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.find_neighbor_for_anynode-Tuple{Batl, Int64}"><a class="docstring-binding" href="#Batsrus.find_neighbor_for_anynode-Tuple{Batl, Int64}"><code>Batsrus.find_neighbor_for_anynode</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Find neighbors for any node in the tree. Only for Cartesian now.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L362-L364">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.find_tree_node-Tuple{Batl, Any}"><a class="docstring-binding" href="#Batsrus.find_tree_node-Tuple{Batl, Any}"><code>Batsrus.find_tree_node</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> find_tree_node(batl, Coord_D)</code></pre><p>Find the node that contains a point. The point coordinates should be given in generalized coordinates normalized by the domain size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L226-L231">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.findindex-Tuple{BatsrusIDL, AbstractString}"><a class="docstring-binding" href="#Batsrus.findindex-Tuple{BatsrusIDL, AbstractString}"><code>Batsrus.findindex</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Find variable index in the BATSRUS data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L162-L164">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.fit_particle_velocity_gmm-Union{Tuple{T}, Tuple{AMReXParticle{T}, Int64}} where T"><a class="docstring-binding" href="#Batsrus.fit_particle_velocity_gmm-Union{Tuple{T}, Tuple{AMReXParticle{T}, Int64}} where T"><code>Batsrus.fit_particle_velocity_gmm</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">fit_particle_velocity_gmm(data, n_clusters; x_range=nothing, y_range=nothing, z_range=nothing, vdim=3)</code></pre><p>Fit a Gaussian Mixture Model to particle velocities in a region.</p><p><strong>Arguments</strong></p><ul><li><code>data</code>: AMReXParticle data.</li><li><code>n_clusters</code>: Number of GMM components.</li><li><code>vdim</code>: Velocity dimension (1, 2, or 3).</li><li><code>kind</code>: Covariance kind, <code>:full</code> (default) or <code>:diag</code>.</li></ul><p><strong>Returns</strong></p><ul><li><p>A vector of named tuples sorted by weight, each containing:</p><ul><li><code>weight</code>: Component weight.</li><li><code>mean</code>: Component mean velocity (vector of length vdim).</li><li><code>cov</code>: Component covariance matrix (vdim x vdim).</li><li><code>vth</code>: Component thermal velocity (diagonal approximation).</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/amrex.jl#L928-L948">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.fit_particle_velocity_gmm-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Int64}} where T"><a class="docstring-binding" href="#Batsrus.fit_particle_velocity_gmm-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Int64}} where T"><code>Batsrus.fit_particle_velocity_gmm</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">fit_particle_velocity_gmm(velocities::AbstractMatrix, n_clusters::Int; weights=nothing, kind=:full)</code></pre><p>Fit a Gaussian Mixture Model to particle velocities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/amrex.jl#L973-L977">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.generate_mock_amrex_data-Tuple{String}"><a class="docstring-binding" href="#Batsrus.generate_mock_amrex_data-Tuple{String}"><code>Batsrus.generate_mock_amrex_data</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> generate_mock_amrex_data(output_dir::String; num_particles::Int=10, 
    real_component_names::Vector{String}=[&quot;u&quot;, &quot;v&quot;],
    particle_gen::Function)</code></pre><p>Generate mock AMReX particle data for testing and benchmarking.</p><p><strong>Arguments</strong></p><ul><li><code>output_dir::String</code>: Directory to save the mock data.</li><li><code>num_particles::Int</code>: Number of particles to generate.</li><li><code>real_component_names::Vector{String}</code>: Names of the extra real components (beyond x, y, z).</li><li><code>particle_gen::Function</code>: A function <code>(i, n_reals) -&gt; tuple</code> that takes an index <code>i</code> (1-based) and the total number of real components <code>n_reals</code>. It should return a tuple of <code>n_reals</code> Float64 values: <code>(x, y, z, comp1, comp2, ...)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L356-L369">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getConnectivity-Tuple{Batl}"><a class="docstring-binding" href="#Batsrus.getConnectivity-Tuple{Batl}"><code>Batsrus.getConnectivity</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Get cell connectivity list.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L522-L524">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getRotationMatrix-Tuple{AbstractVector{&lt;:AbstractFloat}, Real}"><a class="docstring-binding" href="#Batsrus.getRotationMatrix-Tuple{AbstractVector{&lt;:AbstractFloat}, Real}"><code>Batsrus.getRotationMatrix</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getRotationMatrix(axis::AbstractVector, angle::Real) --&gt; SMatrix{3,3}</code></pre><p>Create a rotation matrix for rotating a 3D vector around a unit <code>axis</code> by an <code>angle</code> in radians. Reference: <a href="https://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle">Rotation matrix from axis and angle</a></p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using LinearAlgebra
v = [-0.5, 1.0, 1.0]
v̂ = normalize(v)
θ = deg2rad(-74)
R = getRotationMatrix(v̂, θ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L330-L345">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getSibling-Tuple{Any, Any}"><a class="docstring-binding" href="#Batsrus.getSibling-Tuple{Any, Any}"><code>Batsrus.getSibling</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return sibling index (1-8) for the given block node matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L659-L661">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_anisotropy-Union{Tuple{BatsrusIDL{2, TV}}, Tuple{TV}, Tuple{BatsrusIDL{2, TV}, Any}} where TV"><a class="docstring-binding" href="#Batsrus.get_anisotropy-Union{Tuple{BatsrusIDL{2, TV}}, Tuple{TV}, Tuple{BatsrusIDL{2, TV}, Any}} where TV"><code>Batsrus.get_anisotropy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> get_anisotropy(bd::BatsrusIDL, species=0)</code></pre><p>Calculate the pressure anisotropy for <code>species</code>, indexing from 0. The default <code>method</code> is based on the fact that the trace of the pressure tensor is a constant. The <code>rotation</code> method is based on rotating the tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L269-L275">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_convection_E-Tuple{BatsrusIDL}"><a class="docstring-binding" href="#Batsrus.get_convection_E-Tuple{BatsrusIDL}"><code>Batsrus.get_convection_E</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return the convection electric field from PIC outputs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L327-L329">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_core_population_mask-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector, Union{Real, AbstractVector}}, Tuple{AbstractMatrix{T}, AbstractVector, Union{Real, AbstractVector}, Real}} where T"><a class="docstring-binding" href="#Batsrus.get_core_population_mask-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector, Union{Real, AbstractVector}}, Tuple{AbstractMatrix{T}, AbstractVector, Union{Real, AbstractVector}, Real}} where T"><code>Batsrus.get_core_population_mask</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_core_population_mask(velocities, bulk_vel, vth, nsigma=3.0)</code></pre><p>Identify core population particles based on velocity distribution. Returns a BitVector where true indicates a core particle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/amrex.jl#L888-L893">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_gmm_thermal_velocity-Union{Tuple{T}, Tuple{Any, AbstractVector{T}}} where T"><a class="docstring-binding" href="#Batsrus.get_gmm_thermal_velocity-Union{Tuple{T}, Tuple{Any, AbstractVector{T}}} where T"><code>Batsrus.get_gmm_thermal_velocity</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_gmm_thermal_velocity(gmm_component, b_field)</code></pre><p>Calculate parallel and perpendicular thermal velocities from a GMM component.</p><p><strong>Returns</strong></p><ul><li><code>(v_th_para, v_th_perp)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/amrex.jl#L1034-L1042">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_hall_E-Tuple{BatsrusIDL}"><a class="docstring-binding" href="#Batsrus.get_hall_E-Tuple{BatsrusIDL}"><code>Batsrus.get_hall_E</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return the Hall electric field from PIC outputs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L348-L350">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_magnitude"><a class="docstring-binding" href="#Batsrus.get_magnitude"><code>Batsrus.get_magnitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> get_magnitude(bd::BatsrusIDL, var)</code></pre><p>Calculate the magnitude of vector <code>var</code>. See <a href="#Batsrus.get_vectors-Tuple{BatsrusIDL, Any}"><code>get_vectors</code></a> for the options.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L227-L231">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_magnitude2"><a class="docstring-binding" href="#Batsrus.get_magnitude2"><code>Batsrus.get_magnitude2</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> get_magnitude2(bd::BatsrusIDL, var)</code></pre><p>Calculate the magnitude square of vector <code>var</code>. See <a href="#Batsrus.get_vectors-Tuple{BatsrusIDL, Any}"><code>get_vectors</code></a> for the options.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L211-L215">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_particle_field_aligned_transform"><a class="docstring-binding" href="#Batsrus.get_particle_field_aligned_transform"><code>Batsrus.get_particle_field_aligned_transform</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_particle_field_aligned_transform(b_field, e_field=nothing)</code></pre><p>Return a transformation function that converts particle data to a field-aligned coordinate system.</p><p>If only <code>b_field</code> is provided, the velocity components are decomposed into parallel and perpendicular to the magnetic field. If <code>e_field</code> is also provided, an orthonormal basis (<span>$\hat{\mathbf{b}}$</span>, <span>$\hat{\mathbf{e}}$</span>, <span>$\hat{\mathbf{d}}$</span>) is created, where <span>$\hat{\mathbf{d}} \propto \mathbf{B} \times \mathbf{E}$</span> and <span>$\hat{\mathbf{e}} = \hat{\mathbf{d}} \times \hat{\mathbf{b}}$</span>.</p><p>The returned function takes <code>(data, names)</code> and returns <code>(new_data, new_names)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L468-L478">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_range-Union{Tuple{BatsrusIDLStructured{2, TV, TX, TW}}, Tuple{TW}, Tuple{TX}, Tuple{TV}} where {TV, TX, TW}"><a class="docstring-binding" href="#Batsrus.get_range-Union{Tuple{BatsrusIDLStructured{2, TV, TX, TW}}, Tuple{TW}, Tuple{TX}, Tuple{TV}} where {TV, TX, TW}"><code>Batsrus.get_range</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return mesh range of <code>bd</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L283-L285">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_timeseries-Tuple{AbstractArray, Any}"><a class="docstring-binding" href="#Batsrus.get_timeseries-Tuple{AbstractArray, Any}"><code>Batsrus.get_timeseries</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> get_timeseries(files::AbstractArray, loc; tstep = 1.0)</code></pre><p>Extract plasma moments and EM field from PIC output <code>files</code> at <code>loc</code> with nearest neighbor. Currently only works for 2D outputs. If a single point variable is needed, see <a href="#Batsrus.interp1d-Union{Tuple{TW}, Tuple{TX}, Tuple{TV}, Tuple{BatsrusIDLStructured{2, TV, TX, TW}, AbstractString, AbstractVector{&lt;:AbstractFloat}}} where {TV, TX, TW}"><code>interp1d</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L370-L375">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_var_range-Tuple{BatsrusIDL, Any}"><a class="docstring-binding" href="#Batsrus.get_var_range-Tuple{BatsrusIDL, Any}"><code>Batsrus.get_var_range</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return value range of <code>var</code> in <code>bd</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L278-L280">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.get_vectors-Tuple{BatsrusIDL, Any}"><a class="docstring-binding" href="#Batsrus.get_vectors-Tuple{BatsrusIDL, Any}"><code>Batsrus.get_vectors</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> get_vectors(bd::BatsrusIDL, var)</code></pre><p>Return a tuple of vectors of <code>var</code>. <code>var</code> can be <code>:B</code>, <code>:E</code>, <code>:U</code>, or any <code>:U</code> followed by an index (e.g. <code>:U0</code> for species 0, <code>:U1</code> for species 1, etc.).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L243-L247">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getascii!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, Any, IOStream}} where {T, N}"><a class="docstring-binding" href="#Batsrus.getascii!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, Any, IOStream}} where {T, N}"><code>Batsrus.getascii!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Read ascii format coordinates and data values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L460-L462">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getbinary!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, Any, IOStream}} where {T, N}"><a class="docstring-binding" href="#Batsrus.getbinary!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, Any, IOStream}} where {T, N}"><code>Batsrus.getbinary!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Read binary format coordinates and data values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L497-L499">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getfilehead-Tuple{IOStream, Batsrus.FileList}"><a class="docstring-binding" href="#Batsrus.getfilehead-Tuple{IOStream, Batsrus.FileList}"><code>Batsrus.getfilehead</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getfilehead(fileID::IoStream, filelist::FileList) -&gt; NameTuple</code></pre><p>Obtain the header information from BATSRUS output file of <code>type</code> linked to <code>fileID</code>.</p><p><strong>Input arguments</strong></p><ul><li><code>fileID::IOStream</code>: file identifier.</li><li><code>filelist::FileList</code>: file information.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L282-L291">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getfiletype-Tuple{AbstractString}"><a class="docstring-binding" href="#Batsrus.getfiletype-Tuple{AbstractString}"><code>Batsrus.getfiletype</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Obtain file type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L238-L240">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getvar-Union{Tuple{TV}, Tuple{ndim}, Tuple{BatsrusIDL{ndim, TV}, AbstractString}} where {ndim, TV}"><a class="docstring-binding" href="#Batsrus.getvar-Union{Tuple{TV}, Tuple{ndim}, Tuple{BatsrusIDL{ndim, TV}, AbstractString}} where {ndim, TV}"><code>Batsrus.getvar</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getvar(bd::BATS, var::AbstractString) -&gt; Array</code></pre><p>Return variable data from string <code>var</code>. This is also supported via direct indexing. Note that the query variable <code>var</code> must be in lowercase!</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">bd[&quot;rho&quot;]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L177-L188">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.getview-Union{Tuple{TV}, Tuple{BatsrusIDL{1, TV}, Any}} where TV"><a class="docstring-binding" href="#Batsrus.getview-Union{Tuple{TV}, Tuple{BatsrusIDL{1, TV}, Any}} where TV"><code>Batsrus.getview</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return view of variable <code>var</code> in <code>bd</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L263-L265">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.ibits-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#Batsrus.ibits-Tuple{Any, Any, Any}"><code>Batsrus.ibits</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Logical shifts as the Fortran instrinsic function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L280-L282">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.interp1d-Union{Tuple{TW}, Tuple{TX}, Tuple{TV}, Tuple{BatsrusIDLStructured{2, TV, TX, TW}, AbstractString, AbstractVector{&lt;:AbstractFloat}}} where {TV, TX, TW}"><a class="docstring-binding" href="#Batsrus.interp1d-Union{Tuple{TW}, Tuple{TX}, Tuple{TV}, Tuple{BatsrusIDLStructured{2, TV, TX, TW}, AbstractString, AbstractVector{&lt;:AbstractFloat}}} where {TV, TX, TW}"><code>Batsrus.interp1d</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> interp1d(bd::BatsrusIDLStructured, var::AbstractString, loc::AbstractVector{&lt;:AbstractFloat})</code></pre><p>Interpolate <code>var</code> at spatial point <code>loc</code> in <code>bd</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L212-L216">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.interp1d-Union{Tuple{TW}, Tuple{TX}, Tuple{TV}, Tuple{BatsrusIDLStructured{2, TV, TX, TW}, AbstractString, Vector, Vector}} where {TV, TX, TW}"><a class="docstring-binding" href="#Batsrus.interp1d-Union{Tuple{TW}, Tuple{TX}, Tuple{TV}, Tuple{BatsrusIDLStructured{2, TV, TX, TW}, AbstractString, Vector, Vector}} where {TV, TX, TW}"><code>Batsrus.interp1d</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> interp1d(bd::BatsrusIDLStructured, var::AbstractString, point1::Vector, point2::Vector)</code></pre><p>Interpolate <code>var</code> along a line from <code>point1</code> to <code>point2</code> in <code>bd</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L229-L233">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.interp2d"><a class="docstring-binding" href="#Batsrus.interp2d"><code>Batsrus.interp2d</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> interp2d(bd::BatsrusIDL, var::AbstractString, plotrange=[-Inf, Inf, -Inf, Inf],
	 plotinterval=Inf; kwargs...)</code></pre><p>Return 2D interpolated slices of data <code>var</code> from <code>bd</code>. If <code>plotrange</code> is not set, output data resolution is the same as the original.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>innermask=false</code>: Whether to mask the inner boundary with NaN.</li><li><code>rbody=1.0</code>: Radius of the inner mask. Used when the rbody parameter is not found in the header.</li><li><code>useMatplotlib=true</code>: Whether to Matplotlib (faster) or NaturalNeighbours for scattered interpolation. If true, a linear interpolation is performed on a constructed triangle mesh.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L3-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.interpolate2d_generalized_coords-Union{Tuple{T}, Tuple{T, T, T, Vector{&lt;:AbstractFloat}, Real}} where T&lt;:(AbstractVector)"><a class="docstring-binding" href="#Batsrus.interpolate2d_generalized_coords-Union{Tuple{T}, Tuple{T, T, T, Vector{&lt;:AbstractFloat}, Real}} where T&lt;:(AbstractVector)"><code>Batsrus.interpolate2d_generalized_coords</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Perform Triangle interpolation of 2D data <code>W</code> on grid <code>X</code>, <code>Y</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L196-L198">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.load-Tuple{AbstractString}"><a class="docstring-binding" href="#Batsrus.load-Tuple{AbstractString}"><code>Batsrus.load</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> load(filename; npict=1, verbose=false)</code></pre><p>Read BATSRUS output files. Stores the <code>npict</code> snapshot from an ascii or binary data file into the arrays of coordinates <code>x</code> and data <code>w</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L7-L11">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.meshgrid"><a class="docstring-binding" href="#Batsrus.meshgrid"><code>Batsrus.meshgrid</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Return the axis range for 2D outputs. See <a href="#Batsrus.interp2d"><code>interp2d</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L115-L117">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.meshgrid-Tuple{Any, Any}"><a class="docstring-binding" href="#Batsrus.meshgrid-Tuple{Any, Any}"><code>Batsrus.meshgrid</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Generating consistent 2D arrays for passing to plotting functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L172-L174">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.nodeToGlobalBlock-Tuple{Batl, Int32, Any}"><a class="docstring-binding" href="#Batsrus.nodeToGlobalBlock-Tuple{Batl, Int32, Any}"><code>Batsrus.nodeToGlobalBlock</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return global block index for the node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L502-L504">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.order_children!-Tuple{Batl, Int32, Int64, Vector{Int32}}"><a class="docstring-binding" href="#Batsrus.order_children!-Tuple{Batl, Int32, Int64, Vector{Int32}}"><code>Batsrus.order_children!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> order_children!(batl::Batl, iNode, iMorton::Int, iNodeMorton_I::Vector{Int32})</code></pre><p>Recursively apply Morton ordering for nodes below a root block. Store result into iNodeMorton<em>I and iMortonNode</em>A using the iMorton index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L338-L343">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.order_tree-Tuple{Batl}"><a class="docstring-binding" href="#Batsrus.order_tree-Tuple{Batl}"><code>Batsrus.order_tree</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> order_tree(batl)</code></pre><p>Return maximum AMR level in the used block and the Morton curve order. Set iNodeMorton_I indirect index arrays according to</p><ol><li>root node order</li><li>Morton ordering for each root node</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L294-L302">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.readhead-Tuple{Any}"><a class="docstring-binding" href="#Batsrus.readhead-Tuple{Any}"><code>Batsrus.readhead</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return BATL header from info file. Currently only designed for 2D and 3D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L89-L91">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.readlogdata-Tuple{AbstractString}"><a class="docstring-binding" href="#Batsrus.readlogdata-Tuple{AbstractString}"><code>Batsrus.readlogdata</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Read information from log file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L42-L44">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.readtecdata-Tuple{AbstractString}"><a class="docstring-binding" href="#Batsrus.readtecdata-Tuple{AbstractString}"><code>Batsrus.readtecdata</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> readtecdata(file; verbose=false)</code></pre><p>Return header, data and connectivity from BATSRUS Tecplot outputs. Both 2D and 3D binary and ASCII formats are supported.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">file = &quot;3d_ascii.dat&quot;
head, data, connectivity = readtecdata(file)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L73-L84">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.readtree-Tuple{Any}"><a class="docstring-binding" href="#Batsrus.readtree-Tuple{Any}"><code>Batsrus.readtree</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return BATL tree structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/vtk.jl#L172-L174">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.rotateTensorToVectorZ-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Any}} where T"><a class="docstring-binding" href="#Batsrus.rotateTensorToVectorZ-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Any}} where T"><code>Batsrus.rotateTensorToVectorZ</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> rotateTensorToVectorZ(tensor::AbstractMatrix, v::AbstractVector) -&gt; SMatrix{3,3}</code></pre><p>Rotate <code>tensor</code> with a rotation matrix that aligns the 3rd direction with <code>vector</code>, which is equivalent to change the basis from (i,j,k) to (i′,j′,k′) where k′ ∥ vector. Reference: <a href="https://math.stackexchange.com/questions/2303869/tensor-rotation">Tensor rotation</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L312-L317">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.showhead"><a class="docstring-binding" href="#Batsrus.showhead"><code>Batsrus.showhead</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> showhead(file, head)</code></pre><p>Displaying file header information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L524-L528">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.showhead-Tuple{BatsrusIDL}"><a class="docstring-binding" href="#Batsrus.showhead-Tuple{BatsrusIDL}"><code>Batsrus.showhead</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> showhead(data)
 showhead(io, data)</code></pre><p>Display file information of <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/io.jl#L566-L571">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.slice1d"><a class="docstring-binding" href="#Batsrus.slice1d"><code>Batsrus.slice1d</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> slice1d(bd, var, icut::Int=1, dir::Int=2)</code></pre><p>Return view of variable <code>var</code> in <code>bd</code> along 1D slice. <code>icut</code> is the index along axis <code>dir</code>. <code>dir == 1</code> means align with the 2nd (y) axis, <code>dir == 2</code> means align with the 1st (x) axis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L255-L260">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.squeeze-Tuple{AbstractArray}"><a class="docstring-binding" href="#Batsrus.squeeze-Tuple{AbstractArray}"><code>Batsrus.squeeze</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Squeeze singleton dimensions for an array <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/utility.jl#L303-L305">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.subsurface-NTuple{4, Any}"><a class="docstring-binding" href="#Batsrus.subsurface-NTuple{4, Any}"><code>Batsrus.subsurface</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">subsurface(x, y, data, limits)
subsurface(x, y, u, v, limits)</code></pre><p>Extract subset of 2D surface dataset in ndgrid format. See also: <a href="#Batsrus.subvolume-NTuple{5, Any}"><code>subvolume</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L61-L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.subvolume-NTuple{5, Any}"><a class="docstring-binding" href="#Batsrus.subvolume-NTuple{5, Any}"><code>Batsrus.subvolume</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">subvolume(x, y, z, data, limits)
subvolume(x, y, z, u, v, w, limits)</code></pre><p>Extract subset of 3D dataset in ndgrid format. See also: <a href="#Batsrus.subsurface-NTuple{4, Any}"><code>subsurface</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/select.jl#L116-L121">source</a></section></details></article><h2 id="UnitfulBatsrus"><a class="docs-heading-anchor" href="#UnitfulBatsrus">UnitfulBatsrus</a><a id="UnitfulBatsrus-1"></a><a class="docs-heading-anchor-permalink" href="#UnitfulBatsrus" title="Permalink"></a></h2><h2 id="HDF"><a class="docs-heading-anchor" href="#HDF">HDF</a><a id="HDF-1"></a><a class="docs-heading-anchor-permalink" href="#HDF" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Batsrus.HDF"><a class="docstring-binding" href="#Batsrus.HDF"><code>Batsrus.HDF</code></a> — <span class="docstring-category">Module</span></summary><section><div><p>Module for BATSRUS HDF5 file processing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L1-L3">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.BatsrusHDF5Uniform"><a class="docstring-binding" href="#Batsrus.HDF.BatsrusHDF5Uniform"><code>Batsrus.HDF.BatsrusHDF5Uniform</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>BATSRUS HDF5 file with uniform Cartesian mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L70-L72">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.HDF5Common"><a class="docstring-binding" href="#Batsrus.HDF.HDF5Common"><code>Batsrus.HDF.HDF5Common</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>BATSRUS hdf5 file wrapper.</p><p>The data are stored in blocks, i.e., each field component is stored in a 4D array in the order (iblock, iz, iy, ix). This is a generic wrapper and does not assume grid type, i.e., uniform, stretched nonuniform, or AMR, etc. Classes to handle data with different grids can be derived from this class.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L13-L20">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.coord2index-Union{Tuple{TF}, Tuple{TI}, Tuple{BatsrusHDF5Uniform{TI, TF}, Int64, Real}} where {TI, TF}"><a class="docstring-binding" href="#Batsrus.HDF.coord2index-Union{Tuple{TF}, Tuple{TI}, Tuple{BatsrusHDF5Uniform{TI, TF}, Int64, Real}} where {TI, TF}"><code>Batsrus.HDF.coord2index</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return lower corner index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L158-L160">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.extract_var-Union{Tuple{TF}, Tuple{TI}, Tuple{BatsrusHDF5Uniform{TI, TF}, String}} where {TI, TF}"><a class="docstring-binding" href="#Batsrus.HDF.extract_var-Union{Tuple{TF}, Tuple{TI}, Tuple{BatsrusHDF5Uniform{TI, TF}, String}} where {TI, TF}"><code>Batsrus.HDF.extract_var</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> extract_var(file::BatsrusHDF5Uniform, var::String; kwargs...)</code></pre><p>Extract variable <code>var</code> from HDF5 <code>file</code>.</p><p><strong>Keywords</strong></p><ul><li><code>xmin</code>: minimum extracted coordinate in x.</li><li><code>xmax</code>: maximum extracted coordinate in x.</li><li><code>stepx</code>: extracted stride in x.</li><li><code>ymin</code>: minimum extracted coordinate in y.</li><li><code>ymax</code>: maximum extracted coordinate in y.</li><li><code>stepy</code>: extracted stride in y.</li><li><code>zmin</code>: minimum extracted coordinate in z.</li><li><code>zmax</code>: maximum extracted coordinate in z.</li><li><code>stepz</code>: extracted stride in z.</li><li><code>verbose::Bool=true</code>: display type and size information of output variable.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L253-L270">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.global_slice_to_local_slice-Tuple{BatsrusHDF5Uniform, Int64, OrdinalRange, Int64}"><a class="docstring-binding" href="#Batsrus.HDF.global_slice_to_local_slice-Tuple{BatsrusHDF5Uniform, Int64, OrdinalRange, Int64}"><code>Batsrus.HDF.global_slice_to_local_slice</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> global_slice_to_local_slice(file::BatsrusHDF5Uniform, dim, gslc, ib)</code></pre><p>Convert global slice <code>gslc</code> to local slice <code>lslc</code> on a given block index <code>ib</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L238-L242">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.prep_extract-Tuple{BatsrusHDF5Uniform}"><a class="docstring-binding" href="#Batsrus.HDF.prep_extract-Tuple{BatsrusHDF5Uniform}"><code>Batsrus.HDF.prep_extract</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> prep_extract(file::BatsrusHDF5Uniform, vmin=-Inf, vmax=Inf, step=1)</code></pre><p>Get info for data extraction in 1D.</p><p><strong>Keywords</strong></p><ul><li><code>vmin, vmax</code>: requested coordinate range (corner values).</li><li><code>step</code>: stride.</li></ul><p><strong>Returns:</strong></p><ul><li><code>gslc</code>: global slice.</li><li><code>vmin_new, vmax_new</code>: adjusted coordinate range (corner values).</li><li><code>ibmin:ibmax</code>: block range.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L122-L137">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.prep_extract_per_block-Tuple{BatsrusHDF5Uniform, Int64, OrdinalRange, Int64}"><a class="docstring-binding" href="#Batsrus.HDF.prep_extract_per_block-Tuple{BatsrusHDF5Uniform, Int64, OrdinalRange, Int64}"><code>Batsrus.HDF.prep_extract_per_block</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> prep_extract_per_block(file::BatsrusHDF5Uniform, dim, gslc, ib)</code></pre><p>Get info for data extraction on a single block.</p><p><strong>Arguments</strong></p><ul><li><code>gslc</code>: global slice from prep_extract.</li><li><code>ib::Int</code>: block index.</li></ul><p><strong>Returns</strong></p><ul><li><code>lslc</code>: range to be used on the current block.</li><li><code>ix0:ix1</code>: index range in the global array.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L210-L224">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.prepslice-Tuple{BatsrusHDF5Uniform}"><a class="docstring-binding" href="#Batsrus.HDF.prepslice-Tuple{BatsrusHDF5Uniform}"><code>Batsrus.HDF.prepslice</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> prepslice(file::BatsrusHDF5Uniform; dim::Int, vmin, vmax, step=1)</code></pre><p>Return range that covers [<code>vmin</code>, <code>vmax</code>) along dimension <code>dim</code>.</p><p><strong>Returns</strong></p><ul><li><code>slc_new</code>: trimed slice. If the object&#39;s Nx==1, then 1:1 will be returned.</li><li><code>xl_new</code>: adjusted lower corner coordinate matching <code>slc_new.start</code>.</li><li><code>xu_new</code>: adjusted lower corner coordinate matching <code>slc_new.stop</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L169-L179">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Batsrus.HDF.trimslice-NTuple{4, Any}"><a class="docstring-binding" href="#Batsrus.HDF.trimslice-NTuple{4, Any}"><code>Batsrus.HDF.trimslice</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> trimslice(start, stop, step, stop_max)</code></pre><p>Set slice&#39;s start to be nonnegative and start/stop to be within bound. Reverse slicing is not handled.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/Batsrus.jl/blob/a9512920617ab73c97e7a86579a0710d2e222471/src/hdf.jl#L191-L196">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../examples/">« Examples</a><a class="docs-footer-nextpage" href="../log/">Log »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 9 February 2026 03:22">Monday 9 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
